<!DOCTYPE html><html><head><title>Spring  url-pattern 其中/和/*的区别：</title><meta charset='utf-8'><link href='https://dn-maxiang.qbox.me/res-min/themes/marxico.css' rel='stylesheet'><style>
.note-content  {font-family: 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, Song, sans-serif;}

</style></head><body><div id='preview-contents' class='note-content'>
                        <div id="wmd-preview" class="preview-content"></div>
                    <div id="wmd-preview-section-3017" class="wmd-preview-section preview-content">

</div><div id="wmd-preview-section-3018" class="wmd-preview-section preview-content">

<h1 id="spring-url-pattern-其中和的区别">Spring  url-pattern 其中/和/*的区别：</h1>

<p>&lt; url-pattern &gt; /    不会匹配到<em>.jsp，即：</em>.jsp不会进入spring的 DispatcherServlet类 。  <br>
&lt; url-pattern &gt; /*  会匹配*.jsp，会出现返回jsp视图时再次进入spring的DispatcherServlet 类， 导致找不到对应的controller所以报404错。 </p>

<p>总之，关于web.xml的url映射的小知识:  <br>
&lt; url-pattern&gt;/  会匹配到/login这样的路径型url，不会匹配到模式为*.jsp这样的后缀型url  <br>
&lt; url-pattern&gt;/<em> 会匹配所有url：路径型的和后缀型的url(包括/login,</em>.jsp,<em>.js和</em>.html等)</p>

<p>在web.xml配置servlet-mapping的时候，如果url-pattern设置为“/” (如下)，很多人都会遇到导入js,css,图片等静态资源出现Firefox调试窗口会报出的404错误，而你的确也不能访问那些资源</p>

</div><div id="wmd-preview-section-3019" class="wmd-preview-section preview-content">

<pre class="prettyprint with-line-number hljs-dark"><code class="language-xml hljs"><span class="hljs-comment line-number">1.</span><span class="hljs-tag">&lt;<span class="hljs-title">servlet-mapping</span>&gt;</span><br><span class="hljs-comment line-number">2.</span><span class="hljs-tag">&lt;<span class="hljs-title">servlet-name</span>&gt;</span>dispatcherServlet<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-name</span>&gt;</span><br><span class="hljs-comment line-number">3.</span><span class="hljs-tag">&lt;<span class="hljs-title">url-pattern</span>&gt;</span>/<span class="hljs-tag">&lt;/<span class="hljs-title">url-pattern</span>&gt;</span><br><span class="hljs-comment line-number">4.</span><span class="hljs-tag">&lt;/<span class="hljs-title">servlet-mapping</span>&gt;</span><br></code></pre>

<p>百度了很久，大致有3种方法：但是我仍然没有解决404问题，后来又google了一下，发现少了一个关键的地方（在百度搜索中都没提到的一个地方，所以认为比较关键 :)），就是在jsp页面中导入静态资源的时候需要用标签。</p>

<p>例如：</p>

</div><div id="wmd-preview-section-3020" class="wmd-preview-section preview-content">

<pre class="prettyprint with-line-number hljs-dark"><code class="hljs xml"><span class="hljs-comment line-number">1.</span><span class="hljs-tag">&lt;<span class="hljs-title">%@</span> <span class="hljs-attribute">taglib</span> <span class="hljs-attribute">prefix</span>=<span class="hljs-value">"c"</span> <span class="hljs-attribute">uri</span>=<span class="hljs-value">"http://Java.sun.com/jsp/jstl/core"</span> %&gt;</span><br><span class="hljs-comment line-number">2.</span><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/JavaScript"</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">'&lt;c:url value="/js/jQuery.js"&gt;&lt;/c:url&gt;'</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span><br></code></pre>

<p>这里的c:url中 value的值也是需要特别注意到地方，见下面3种方法详细说明：</p>

<p>方法1. 修改web.xml文件，增加对静态资源的url映射</p>

<p>如：</p>

</div><div id="wmd-preview-section-3021" class="wmd-preview-section preview-content">

<pre class="prettyprint with-line-number hljs-dark"><code class="language-xml hljs"><span class="hljs-comment line-number">1.</span><span class="hljs-tag">&lt;<span class="hljs-title">servlet-mapping</span>&gt;</span><br><span class="hljs-comment line-number">2.</span><span class="hljs-tag">&lt;<span class="hljs-title">servlet-name</span>&gt;</span>default<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-name</span>&gt;</span><br><span class="hljs-comment line-number">3.</span><span class="hljs-tag">&lt;<span class="hljs-title">url-pattern</span>&gt;</span>*.js<span class="hljs-tag">&lt;/<span class="hljs-title">url-pattern</span>&gt;</span><br><span class="hljs-comment line-number">4.</span><span class="hljs-tag">&lt;/<span class="hljs-title">servlet-mapping</span>&gt;</span><br><span class="hljs-comment line-number">5.</span><span class="hljs-tag">&lt;<span class="hljs-title">servlet-mapping</span>&gt;</span><br><span class="hljs-comment line-number">6.</span><span class="hljs-tag">&lt;<span class="hljs-title">servlet-name</span>&gt;</span>default<span class="hljs-tag">&lt;/<span class="hljs-title">servlet-name</span>&gt;</span><br><span class="hljs-comment line-number">7.</span><span class="hljs-tag">&lt;<span class="hljs-title">url-pattern</span>&gt;</span>*.css<span class="hljs-tag">&lt;/<span class="hljs-title">url-pattern</span>&gt;</span><br><span class="hljs-comment line-number">8.</span><span class="hljs-tag">&lt;/<span class="hljs-title">servlet-mapping</span>&gt;</span><br></code></pre>

<p>在web.xml中添加好配置后，在jsp页面就可以引用这些静态资源了，但需要用,</p>

<p>如：</p>

</div><div id="wmd-preview-section-3022" class="wmd-preview-section preview-content">

<pre class="prettyprint with-line-number hljs-dark"><code class="hljs xml"><span class="hljs-comment line-number">1.</span><span class="hljs-tag">&lt;<span class="hljs-title">%@</span> <span class="hljs-attribute">taglib</span> <span class="hljs-attribute">prefix</span>=<span class="hljs-value">"c"</span> <span class="hljs-attribute">uri</span>=<span class="hljs-value">"http://java.sun.com/jsp/jstl/core"</span> %&gt;</span><br><span class="hljs-comment line-number">2.</span><span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/javascript"</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">'&lt;c:url value="/js/jquery.js"&gt;&lt;/c:url&gt;'</span>&gt;</span><span class="undefined"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span><br></code></pre>

<p>这里还需要说明的是：这种方法不能访问WEB-INF目录下的静态资源，也就是js目录必须是web根(可能是webapp,webContent等)目录下，否则是不能引用的； <br>
如果放在WEB-INF目录下，即使你使用也是会出现404错误的。</p>

<p>百度时发现：以下各容器的default servlet名字，而且还提到静态资源servlet映射需要写在dispatcherServlet的前面；我在Jboss-eap-5.1中测试过，前后没有关系；所以可能是容器或者版本的关系吧。</p>

<p>Tomcat, Jetty, JBoss, and GlassFish  默认 Servlet的名字 – “default” <br>
Google App Engine 默认 Servlet的名字 – “_ah_default” <br>
Resin 默认 Servlet的名字 – “resin-file” <br>
WebLogic 默认 Servlet的名字  – “FileServlet” <br>
WebSphere  默认 Servlet的名字 – “SimpleFileServlet” </p>

<p>方法2.在相应的 -servlet.xml中添加spring配置</p>

<p>如：</p>

</div><div id="wmd-preview-section-3023" class="wmd-preview-section preview-content">

<pre class="prettyprint with-line-number hljs-dark"><code class="hljs aspectj"><span class="hljs-comment line-number">1.</span>&lt;mvc:<span class="hljs-keyword">default</span>-servlet-<span class="hljs-keyword">handler</span>/&gt;<br></code></pre>

<p>这种方法只需要添加一行代码，在jsp页面中引用时和方法1一样，同样也不能引用WEB-INF下的资源。</p>

<p>方法3.使用spring 3.0.4的新特性,在相应的 -servlet.xml中添加配置</p>

<p>如：</p>

</div><div id="wmd-preview-section-3024" class="wmd-preview-section preview-content">

<pre class="prettyprint with-line-number hljs-dark"><code class="hljs xml"><span class="hljs-comment line-number">1.</span><span class="hljs-tag">&lt;<span class="hljs-title">mvc:resources</span> <span class="hljs-attribute">location</span>=<span class="hljs-value">"/js/"</span> <span class="hljs-attribute">mapping</span>=<span class="hljs-value">"/js/**"</span> /&gt;</span><br></code></pre>

<p>或</p>

</div><div id="wmd-preview-section-3025" class="wmd-preview-section preview-content">

<pre class="prettyprint with-line-number hljs-dark"><code class="hljs xml"><span class="hljs-comment line-number">1.</span> <span class="hljs-tag">&lt;<span class="hljs-title">mvc:resources</span> <span class="hljs-attribute">location</span>=<span class="hljs-value">"/WEB-INF/js/"</span> <span class="hljs-attribute">mapping</span>=<span class="hljs-value">"/js/**"</span> /&gt;</span><br></code></pre>

<p>这种方法我写了两个配置，不同的地方只是location的值，一个是“/js/”,一个是“/WEB-INF/js/”；两种都可以，根据你自己的目录结构来引用。这就说明使用这种方式可以引用WEB-INF目录下的静态资源；这里的mapping属性的值用了ant的通配符方式，”/js/<em>*”(两个”</em>“)指location的值所表示的目录以及所有子目录；但是在jsp页面中引用时需要注意：</p>

<p> value的值必须类似于mapping属性的值，如果是3.1方式的配置，则引用的是web根目录下js/jquery.js，如果是3.2方式的配置，则引用的是web根目录下WEB-INF/js/jquery.js; <br>
 则引用location目录下子目录ui下的jquery-ui.js。</p></div><div id="wmd-preview-section-footnotes" class="preview-content"></div></div></body></html>